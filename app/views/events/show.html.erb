<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <title>イベントMAP</title>

  <!-- Leaflet JS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.8.0/dist/leaflet.css" integrity="sha512-hoalWLoI8r4UszCkZ5kL8vayOGVae1oxXe/2A4AO6J9+580uKHDO3JdHb7NzwwzK5xr/Fs0W40kiNHxM9vyTtQ==" crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.8.0/dist/leaflet.js" integrity="sha512-BB3hKbKWOc9Ez/TAwyWxNXeoV9c1v6FIeYiBieIWkpLjauysF18NzgR1MBNBXf8/KABdlkX68nAhlwcDFLGPCQ==" crossorigin=""></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>

  <script type="text/javascript" src="https://d19vzq90twjlae.cloudfront.net/leaflet-0.7.3/leaflet.js"></script>
  <script type="text/javascript" src="https://cdn.rawgit.com/aratcliffe/Leaflet.contextmenu/master/dist/leaflet.contextmenu-src.js"></script>
  <script type="text/javascript" src="https://rawgit.com/w8r/Leaflet.Bookmarks/master/dist/L.Control.Bookmarks.js"></script>
  
  <link rel="stylesheet" href="https://cdn.rawgit.com/aratcliffe/Leaflet.contextmenu/master/dist/leaflet.contextmenu.css">
  <link rel="stylesheet" href="https://rawgit.com/w8r/Leaflet.Bookmarks/master/dist/leaflet.bookmarks.css">
 
  <style>
    html, body {
        height: 100%;
        margin: 0px;
    }

    #map {
        position: static;
        height: 100%;
    }

    
  </style>
</head>

<body>
  <h1><%= t('.title') %></h1>
  <%= link_to 'Edit', edit_event_path(@event) %>
  <%= link_to 'Back', events_path %>

  <div id="map">
    <%= image_tag @event.map_image.url, class: "leaflet-image-layer leaflet-zoom-animated" %>
  </div>
  
  <script>

  //地図を表示するdiv要素のidを設定
  var map = L.map('map').setView([51.505, -0.09], 13);
  var control = new L.Control.Bookmarks().addTo(map);


  //クリックした時のイベント
  map.on('click',function ( e ) {
          //クリックした座標を取得してMarkerを落としつつ、このMarkerをクリックした時のイベントを追加
          marker = L.marker([e.latlng.lat, e.latlng.lng],{}).addTo(map);
          });


  map.fire('bookmark:new', {
          latlng: new L.LatLng([51.505, -0.01], 13)
          });

  var Bookmarks = leafletSrc.Control.extend( /**  @lends Bookmarks.prototype */ {
          title: 'Bookmarks',
                  emptyMessage: 'No bookmarks yet',
                  addBookmarkMessage: 'Add new event',
                  collapseOnClick: true,
                  scrollOnAdd: true,
                  scrollDuration: 1000,
                  popupOnShow: true,
                  addNewOption: true,
  });
          
  </script>
</body>
</html>